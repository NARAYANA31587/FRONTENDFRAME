<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Online Bookstore</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .book { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
    .out-of-stock { color: red; }
    #cart { border-top: 2px solid #333; margin-top: 30px; padding-top: 10px; }
    button { margin-top: 10px; }
  </style>
</head>
<body>

  <h1>Online Bookstore</h1>
  <div id="bookList"></div>
  <div id="cart"></div>

  <script type="module">
    // ---- Mock Book Data (JSON) ----
    const books = [
      { title: "Book One", author: "Author A", price: 10.99, available: true },
      { title: "Book Two", author: "Author B", price: 15.49, available: true },
      { title: "Book Three", author: "Author C", price: 8.99, available: false }
    ];

    // ---- Cart Module ----
    const cart = [];

    function addToCart(book) {
      cart.push(book);
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
    }

    function getCart() {
      return cart;
    }

    function getTotal() {
      return cart.reduce((sum, item) => sum + item.price, 0).toFixed(2);
    }

    // ---- UI Module ----
    function renderCart() {
      const cartDiv = document.getElementById('cart');
      const items = getCart();

      cartDiv.innerHTML = '<h2>Shopping Cart</h2>';

      if (items.length === 0) {
        cartDiv.innerHTML += '<p>Your cart is empty.</p>';
        return;
      }

      items.forEach((item, index) => {
        const div = document.createElement('div');
        div.innerHTML = `
          <p>${item.title} - $${item.price.toFixed(2)}
            <button data-index="${index}">Remove</button>
          </p>
        `;
        cartDiv.appendChild(div);

        div.querySelector('button').addEventListener('click', () => {
          removeFromCart(index);
          renderCart();
        });
      });

      cartDiv.innerHTML += `<h3>Total: $${getTotal()}</h3>`;
    }

    // ---- Book List Module ----
    function loadBooks() {
      const bookList = document.getElementById('bookList');
      bookList.innerHTML = '';

      books.forEach((book, index) => {
        const div = document.createElement('div');
        div.className = 'book';

        div.innerHTML = `
          <h3>${book.title}</h3>
          <p><strong>Author:</strong> ${book.author}</p>
          <p><strong>Price:</strong> $${book.price.toFixed(2)}</p>
          <p class="${book.available ? '' : 'out-of-stock'}">
            ${book.available ? 'In Stock' : 'Out of Stock'}
          </p>
          <button ${!book.available ? 'disabled' : ''}>Add to Cart</button>
        `;

        bookList.appendChild(div);

        if (book.available) {
          div.querySelector('button').addEventListener('click', () => {
            addToCart(book);
            renderCart();
          });
        }
      });
    }

    // ---- Main App Init ----
    document.addEventListener('DOMContentLoaded', () => {
      loadBooks();
      renderCart();
    });
  </script>
</body>
</html>
